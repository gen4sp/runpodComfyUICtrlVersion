# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ python_packages

## –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

‚úÖ **1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—è `python_packages`**

-   –§–∞–π–ª: `rp_handler/resolver.py` ‚Üí —Ñ—É–Ω–∫—Ü–∏—è `validate_version_spec`
-   –ü–æ–ª–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ, —Ç–∏–ø: —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫
-   –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç ‚Äî —Å—Ç—Ä–æ–∫–∞ (–∏–º—è –ø–∞–∫–µ—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ pip)

‚úÖ **2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ resolve_version_spec**

-   –§–∞–π–ª: `rp_handler/resolver.py` ‚Üí —Ñ—É–Ω–∫—Ü–∏—è `resolve_version_spec`
-   –ü–æ–ª–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –≤ resolved lock –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
-   –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏

‚úÖ **3. –î–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ –≤ realize_from_resolved**

-   –§–∞–π–ª: `rp_handler/resolver.py` ‚Üí —Ñ—É–Ω–∫—Ü–∏—è `realize_from_resolved`
-   –ü–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∫–∞—Å—Ç–æ–º-–Ω–æ–¥
-   –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `should_prepare=True` –∏ –Ω–µ –≤ offline —Ä–µ–∂–∏–º–µ
-   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è venv Python –∏–∑ `COMFY_HOME/.venv`
-   –ü–æ–¥–¥–µ—Ä–∂–∫–∞ `--wheels-dir` –¥–ª—è offline —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω)

‚úÖ **4. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

-   `docs/readme.md` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
-   `docs/instructions.md` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–µ—Ä—Å–∏–∏"
-   `docs/python_packages.md` ‚Äî —Å–æ–∑–¥–∞–Ω –ø–æ–ª–Ω—ã–π –≥–∞–π–¥ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
-   –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å —Ä–∞–∑–Ω—ã–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ –≤–µ—Ä—Å–∏–π

‚úÖ **5. –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã**

-   –§–∞–π–ª: `tests/test_resolver.py`
-   –¢–µ—Å—Ç —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏: ‚úÖ –ø—Ä–æ—Ö–æ–¥–∏—Ç
-   –¢–µ—Å—Ç –±–µ–∑ –ø–æ–ª—è python_packages (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): ‚úÖ –ø—Ä–æ—Ö–æ–¥–∏—Ç
-   –¢–µ—Å—Ç —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º —Ç–∏–ø–æ–º (—Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ —Å–ø–∏—Å–∫–∞): ‚úÖ –ø—Ä–æ—Ö–æ–¥–∏—Ç
-   –í—Å–µ 8 —Ç–µ—Å—Ç–æ–≤ –≤ test_resolver.py: ‚úÖ –ø—Ä–æ—Ö–æ–¥—è—Ç

‚úÖ **6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å —Ä–µ–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ñ–∏–≥–æ–º**

-   `versions/wan22-fast.json` —Å–æ–¥–µ—Ä–∂–∏—Ç python_packages: ‚úÖ
-   –ö–æ–º–∞–Ω–¥–∞ `validate wan22-fast` —Ä–∞–±–æ—Ç–∞–µ—Ç: ‚úÖ
-   Resolved lock —Å–æ–¥–µ—Ä–∂–∏—Ç python_packages: ‚úÖ

## –§–æ—Ä–º–∞—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```json
{
  "schema_version": 2,
  "version_id": "my-version",
  "comfy": { ... },
  "custom_nodes": [ ... ],
  "models": [ ... ],
  "python_packages": [
    "sageattention",
    "onnx>=1.14",
    "onnxruntime-gpu"
  ],
  "env": {},
  "options": {}
}
```

## –ü–æ—Ä—è–¥–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏ realize

1. ComfyUI core requirements.txt
2. Custom nodes requirements.txt (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
3. **python_packages –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏** ‚Üê –ù–û–í–û–ï
4. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–µ–π
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –í–∞–ª–∏–¥–∞—Ü–∏—è
python3 scripts/version.py validate wan22-fast

# –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø–∞–∫–µ—Ç—ã)
python3 scripts/version.py realize wan22-fast

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
$COMFY_HOME/.venv/bin/python -m pip list | grep sageattention
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

-   ‚úÖ Offline —Ä–µ–∂–∏–º: –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
-   ‚úÖ Wheels dir: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ `--wheels-dir`
-   ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø—Ä–æ—Ü–µ—Å—Å–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
-   ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ –±–µ–∑ python_packages —Ä–∞–±–æ—Ç–∞—é—Ç
-   ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è: —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

-   `rp_handler/resolver.py` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
-   `docs/readme.md` ‚Äî –æ–±–Ω–æ–≤–ª—ë–Ω —Ä–∞–∑–¥–µ–ª –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π
-   `docs/instructions.md` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
-   `docs/python_packages.md` ‚Äî –Ω–æ–≤—ã–π —Ñ–∞–π–ª —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
-   `tests/test_resolver.py` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã 3 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–∞

## –°—Ç–∞—Ç—É—Å

üéâ **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞**

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ü–æ–ª–µ `python_packages` –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–º–∞–Ω–¥–µ `python3 scripts/version.py realize`.
